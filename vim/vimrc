" General Preferences
" ---------------------------------------------------------------------------

set nocompatible                  " Do not include vi compatibility.
syntax enable                     " Turn on syntax highlighting.
set modelines=0                   " disable modelines
set encoding=utf-8                " Set default encoding
set ttyfast                       " Tell vim you're using a fast terminal.
set title                         " Set the terminal's title
set visualbell                    " Make the alerts visual instead of audio
set hidden                        " Hide buffers instead of close them (when opening a new buffer)
set wildmenu                      " Enhanced command line completion.
set wildmode=list:longest         " Complete files like a shell.
set ignorecase                    " Case-insensitive searching.
set smartcase                     " But case-sensitive if expression contains a capital letter.
set incsearch                     " Highlight matches as you type.
set nohlsearch                    " Don't highlight search matches.
set showmatch                     " Show matching brackets, etc.
set t_Co=256                      " Setup term color support
set gdefault                      " Sets searches to be global (line) by default
set autoread                      " Tells vim to auto-read changes to the file from the disk.
set ttimeoutlen=50                " no delay leaving insert mode
set clipboard=unnamed             " set vim to share the system clipboard
set wrap                          " Turn on wrapping
set linebreak                     " Wrap only at word-breaks
set autoindent                    " Turn on auto-indenting
set copyindent                    " copy previous indentation on autoindent
set expandtab                     " Use spaces instead of tabs
set tabstop=4                     " width of tab character
set softtabstop=4                 " number of characters to delete
set shiftwidth=4                  " indentation settings
set backspace=indent,eol,start    " Intuitive backspacing.
set nojoinspaces                  " Single space between lines when joining
set spell spelllang=en_us         " Turn on spell-checking
set formatoptions=tcrqn           " A few misc options for formatting text,
set formatprg=par\ -w78rq         " external formatter options
set laststatus=2                  " Always show status bar
set cmdheight=1                   " Height of command typing area
set showcmd                       " Shows your typing in Normal Mode
set scrolloff=2                   " Show N lines of context around the cursor at all times.
set cursorline                    " Highlight the line the cursor is on
set number                        " Show line-numbers
set gcr=n:blinkon0                " Turn off the blinking cursor in normal mode
" Open new split panes to right and bottom, which feels more natural
set splitbelow
set splitright

" Custom spell file
set spellfile=~/.vim/custom-dictionary.utf-8.add

" Treat buffers from stdin (e.g.: echo foo | vim -) as scratch buffers.
au StdinReadPost * :set buftype=nofile

" Use the same symbols as TextMate for tabstops and EOLs
set listchars=tab:▸\ ,eol:¬,trail:⌢,extends:⇥,precedes:⇤,nbsp:⌙

" Statusline
set statusline=%f         "path to file in buffer
set statusline+=%m        "modified/modifiable flag
set statusline+=\ %y      "filetype
set statusline+=%=        "left/right alignment separator
set statusline+=%{strlen(&fenc)?&fenc:'none'}[%{&ff}]   "file encoding
set statusline+=\ \ %P      "percentage through file
set statusline+=\ %l,%c   "line,column

if has("gui_macvim")
  let macvim_skip_cmd_opt_movement = 1
endif

" Vundle Stuff
" ---------------------------------------------------------------------------

filetype off                      " required!
set rtp+=~/.vim/bundle/vundle/
call vundle#rc()
" This one is required:
Bundle 'gmarik/vundle'

" Vundles...
Bundle "sjl/gundo.vim"
Bundle 'Shougo/unite.vim'
Bundle 'tpope/vim-surround'
Bundle 'airblade/vim-gitgutter'
Bundle 'junegunn/goyo.vim'
Bundle 'altercation/vim-colors-solarized'
Bundle 'chriskempson/base16-vim'
Bundle 'plasticboy/vim-markdown'
Bundle 'tpope/vim-rsi'
Bundle 'davidoc/taskpaper.vim'

" Must be called after plugins
filetype plugin indent on         " Turn on file type detection.

" COLOR SCHEME
colorscheme base16-ocean
set background=dark


" ---------------------------------------------------------------------------

" DISABLE THE ARROW KEYS - OH GOD...
nnoremap <up> <nop>
nnoremap <down> <nop>
nnoremap <left> <nop>
nnoremap <right> <nop>
inoremap <up> <nop>
inoremap <down> <nop>
inoremap <left> <nop>
inoremap <right> <nop>

" Make j and k behave as expected
nnoremap j gj
nnoremap k gk
vnoremap j gj
vnoremap k gk

" Make entering command-mode easier
nnoremap ; :
vnoremap ; :

" Make moving around splits easier
nnoremap <C-h> <C-w>h
nnoremap <C-j> <C-w>j
nnoremap <C-k> <C-w>k
nnoremap <C-l> <C-w>l

" When moving to the end of the document also move to the end of the line
nnoremap G G$

" make regexp search not suck by default
nnoremap / /\v
vnoremap / /\v

" maintain selection on indentations
vnoremap > >gv
vnoremap < <gv

" ---------------------------------------------------------------------------

" Remap K to split the line at the point
nnoremap K i<cr><esc>`.
inoremap <c-k> <cr><c-o><bs>

" allow saving a sudo file if forgot to open as sudo
cmap w!! w !sudo tee % >/dev/null

" protect against accidental save + close
nnoremap ZZ :echoe "Your Caps-lock is on."<cr>

" Paste mode
set pastetoggle=<F2>

" Cap line and move down
inoremap <c-cr> <esc>VUo

nmap [h <Plug>GitGutterPrevHunk
nmap ]h <Plug>GitGutterNextHunk

" Never use a binding when a command will do
" commands are easier to remember and autocomplete
" also, it's just vim-style
command BGd set background=dark
command BGl set background=light
command Dtrail :%s/\s\+$//<cr>:let @/=''<CR>
command Fmkd :set filetype=mkd
command Frst :set filetype=rst
command H1 :normal VUyypVr=
command H2 :normal yypVr-
command NN :set invnumber
command SS :set spell!
command Src :source ~/.vimrc
command Ub :Unite -no-split -buffer-name=buffer buffer
command Uf :Unite -no-split -buffer-name=file file
command WW :set wrap!


" Snippets
" ---------------------------------------------------------------------------

" Timestamp in brackets like this: [2014-06-08T10:41:44-0700]
iab <expr> dd strftime("[%Y-%m-%dT%H:%M:%S%z]")

" TODO:
" Move lines up/down
" new line, increment number
" <clippings>
"   date (various formats)
"   lorem
"   point-of-view
"   work-in-progress
